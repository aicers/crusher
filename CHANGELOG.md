# Changelog

This file documents recent notable changes to this project. The format of this
file is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/), and
this project adheres to [Semantic
Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Added

- Support `shutdown`, `reload_config` via `oinq`.
- Added a `Certs` to store commonly used certificate information.

### Changed

- Apply Group imports by StdExternalCrate.
  - Modify the code with this command:
    - `cargo fmt -- --config group_imports=StdExternalCrate`.
  - Add `--config group_imports=StdExternalCrate` to the CI process like:
    - `cargo fmt -- --check --config group_imports=StdExternalCrate`
- Changed CrusherConfig with oinq `Config`.
- Modified logging behavior for debug and release builds
- Changed logs to stdout and file
- Updated `set_config` function to record requested configuration changes
  to a temporary toml file. Given the original configuration file name as
  `crusher.toml`, the temporary file is named as `crusher.toml.temp.toml`.
  - If the reload trigger succeeds, the new configuration is applied from the
    temporary file; otherwise, the temporary file is deleted.
- Changed configuration fields name.
  - `roots` to `root`.
  - `giganto_ingest_address` to `giganto_ingest_srv_addr`.
  - `giganto_publish_address` to `giganto_publish_srv_addr`.
  - `review_address` to `review_rpc_srv_addr`.
- Update giganto-client to version `0.17.0`. Updating to this version results
  in the following changes.
  - Bump dependencies.
    - Update quinn to version `0.11`.
    - Update rustls to version `0.23`.
    - Update review-protocol to version `0.3`.
  - Update the protocol version of the giganto ingest, publish module.
    - Changed `PUBLISH_PROTOCOL_VERSION` to "0.21.0-alpha.1"
    - Changed `INGEST_PROTOCOL_VERSION` to "0.21.0-alpha.1"
- Changed the form of timeseries sent to giganto to `Vec<(i64,Vec<u8>)>`.
  Currently, giganto has changed to send and receive a certain number of
  events at once to optimize sending and receiving large amounts of data.
  For timeseries, one event is generated per period, and it takes too long
  to collect and send a certain number of timeseries events, so it was
  changed to send only one event as a vector.

## [0.3.2] - 2024-01-25

### Changed

- Changed `REVIEW_PROTOCOL_VERSION` to "0.27.0"
- Changed `PUBLISH_PROTOCOL_VERSION` to "0.17.0"

## [0.3.1] - 2023-11-07

### Added

- Support remote control
- Send the list of processes to review using oinq.
- Changed `RecordType` to `RawEventKind`, as the communication protocol type
  defined in `Giganto-client 0.15.1` is integrated.

## [0.3.0] - 2023-07-06

### Added

- Add more network data type. (`Mqtt`, `Ldap`, `Tls`, `Smb`, `Nfs`)

## [0.2.0] - 2023-05-19

### Added

- Add more network data type. (`Ftp`)
- Delete the policies by requested IDs.

### Changed

- Removes the `agent_id` provided in the config file. This value is provided by
  the CN in the certificate in the form of `agent_id@host_id`.
- Requires REview 0.23.x

## [0.1.0] - 2023-03-30

### Added

- Receive time series generation `policy` generated by the `review` and
  convert it to a `model`.
- Request a network stream to `giganto`'s publish for each `model`.
- Send the generated `time series` to `giganto`'s ingest.
- Save the model's id and the last time the timeseries was sent to a file.

[Unreleased]: https://github.com/aicers/crusher/compare/0.3.2...main
[0.3.2]: https://github.com/aicers/crusher/compare/0.3.1...0.3.2
[0.3.1]: https://github.com/aicers/crusher/compare/0.3.0...0.3.1
[0.3.0]: https://github.com/aicers/crusher/compare/0.2.0...0.3.0
[0.2.0]: https://github.com/aicers/crusher/compare/0.1.0...0.2.0
[0.1.0]: https://github.com/aicers/crusher/tree/0.1.0
